geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
pal <- c("#ED90A4","#D3A263","#99B657","#33C192","#00BDCE","#94A9EC","#DC91DB")
cols <- c(
"darrers_7"=pal[1],
"sim_median_1_5"=pal[2],
"sim_median_2_4"=pal[3],
"sim_median_3_3"=pal[4],
"sim_median_4_2"=pal[5],
"sim_median_5_1"=pal[6],
"sim_fix_10^7" = pal[7],
"N1" = 'black'
)
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5", alpha=0.1))+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4", alpha=0.1))+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3", alpha=0.1))+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1", alpha=0.1))+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
cols <- c(
"darrers_7"='red',
"sim_median_1_5"=pal[2],
"sim_median_2_4"=pal[3],
"sim_median_3_3"=pal[4],
"sim_median_4_2"=pal[5],
"sim_median_5_1"=pal[6],
"sim_fix_10^7" = pal[7],
"N1" = 'black'
)
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5", alpha=0.1))+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4", alpha=0.1))+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3", alpha=0.1))+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1", alpha=0.1))+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
cor.test(N1_casos$log_7,log10(N1_casos$sim_median_4_2))
cor.test(N1_casos$log_7,log10(N1_casos$sim_median_5_1))
ggplot(N1_casos, aes(load_N1, sim_median_4_2, color=log_N1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
hist(load / (FECmatrix * RNAfecmatrix))
mu=2.11; sigma=0.25;
10^rnorm(n, mu, sigma)
n = 1000
10^rnorm(n, mu, sigma)
hist(10^rnorm(n, mu, sigma))
?rnorm
# shedding rate of SARS-CoV-2 RNA in feces
# log-uniform distribution from 2.56 to 7.67
x = c(2.56, 7.67)
10^(x[1] + (x[2]-x[1]) * runif(n))
?runif
?rbeta
for (i in 1:5){
for (j in 1:nrow(N1_casos)){
# result <- replicate(1000, sim1(load = N1_casos$load_N1[j], beta1 = 6, beta2 = 1))
# sim_median <- median(result)
# #field <- paste("sim_median",beta1[i], beta2[i], sep="_")
# N1_casos[j,"sim_fix_10_7"] <- sim_median
print(c(i,j))
}
}
for (i in 1:5){
for (j in 1:4){
# result <- replicate(1000, sim1(load = N1_casos$load_N1[j], beta1 = 6, beta2 = 1))
# sim_median <- median(result)
# #field <- paste("sim_median",beta1[i], beta2[i], sep="_")
# N1_casos[j,"sim_fix_10_7"] <- sim_median
print(c(i,j))
}
}
for (i in 1:5){
print(c("beta1", beta1[i], "beta2", beta2[i]))
}
beta1 <- 1:5
beta2 <- 5:1
for (i in 1:5){
print(c("beta1", beta1[i], "beta2", beta2[i]))
}
?quantile
ggplot(N1_casos, aes(x=Data.mostreig))+
# geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5", alpha=0.1))+
# geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4", alpha=0.1))+
# geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3", alpha=0.1))+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
# geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1", alpha=0.1))+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
# geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5", alpha=0.1))+
# geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4", alpha=0.1))+
# geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3", alpha=0.1))+
# geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1", alpha=0.1))+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5", alpha=0.1))+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4", alpha=0.1))+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3", alpha=0.1))+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1", alpha=0.1))+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7", alpha=0.1))+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"Z), alpha=0.1)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"Z), alpha=0.1)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"Z), alpha=0.1)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=0.1)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=0.1)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=0.1)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=0.1)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=0.1)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=0.1)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=0.1)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"))+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=0.1)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=0.1)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=0.1)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"))+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=0.1)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=0.1)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=0.1)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
alpha_value <- 0.2
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
alpha_value <- 1
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
alpha_value <- 0.8
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
cols <- c(
"darrers_7"='red',
"sim_median_1_5"=pal[2],
"sim_median_2_4"=pal[3],
"sim_median_3_3"=pal[4],
"sim_median_4_2"=pal[5],
"sim_median_5_1"=pal[6],
"sim_fix_10^7" = pal[7],
"N1" = 'black'
)
alpha_value <- 0.8
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
alpha_value <- 1
ggplot(N1_casos, aes(x=Data.mostreig))+
geom_line(aes(y=sim_median_1_5+1, group=EDAR, color="sim_median_1_5"), alpha=alpha_value)+
geom_line(aes(y=sim_median_2_4+1, group=EDAR, color="sim_median_2_4"), alpha=alpha_value)+
geom_line(aes(y=sim_median_3_3+1, group=EDAR, color="sim_median_3_3"), alpha=alpha_value)+
geom_line(aes(y=sim_median_4_2+1, group=EDAR, color="sim_median_4_2"), alpha=alpha_value)+
geom_line(aes(y=sim_median_5_1+1, group=EDAR, color="sim_median_5_1"), alpha=alpha_value)+
geom_line(aes(y=darrers_7+1, group=EDAR, color="darrers_7"), alpha=alpha_value)+
geom_line(aes(y=load_N1, group=EDAR, color="N1"), alpha=alpha_value)+
scale_color_manual(name="", values=cols)+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
legend.title = element_blank())+
scale_y_log10()
ggplot(N1_casos, aes(load_N1, sim_median_4_2, color=log_N1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1, color=log_N1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1, color=load_N1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1)+
ggplot(N1_casos, aes(load_N1, sim_median_5_1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1))+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1), color='red')+
geom_point()+
geom_smooth()+
scale_color_viridis()
ggplot(N1_casos, aes(load_N1, sim_median_5_1))+
geom_point(color='red')+
geom_smooth()+
scale_color_viridis()
library(tidyverse)
library(lubridate)
library(viridis)
source('C:/Users/jpueyo/OneDrive - ICRA/Other projects/sarsaigua/scripts/functions.R')
setwd("C:/Users/jpueyo/OneDrive - ICRA/Other projects/sarsaigua/results")
#load excel
data <- load_excel()
#create casos for N1 and correlation
N1_casos <- N1_data(data)
#generate a field with rowname
N1_casos$row <- as.integer(rownames(N1_casos))
#generate variables where store slopes
N1_casos$slope_log_7 <- NA
N1_casos$slope_log_N1 <- NA
#indicate size of backtime window
n_casos <- 3
#calculate slope for log_7 and log_N1
for (edar in levels(N1_casos$EDAR)){
casos_edar <- N1_casos %>%
filter(EDAR == edar,
!is.na(log_7),
!is.na(log_N1)) %>%
arrange(Data.mostreig)
for (i in 1:nrow(casos_edar)){
#calculate y for log_7
slope <- create_slope(casos_edar, "log_7", 1, direction = 1)
N1_casos$slope_log_7[casos_edar$row[i]] <- slope
#calculate y for log_N1
slope <- create_slope(casos_edar, "log_N1", 3, direction = -1)
N1_casos$slope_log_N1[casos_edar$row[i]] <- slope
}
}
#calculate correlation
cor.test(N1_casos$slope_log_7, N1_casos$slope_log_N1, method="pearson")
#scatterplot with slopes
N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+geom_point()+geom_smooth()
scale_color_viridis()
#example of data for one EDAR
N1_casos %>%
filter(EDAR == "DGIR") %>%
arrange(Data.mostreig) %>%
ggplot(aes(Data.mostreig, log_N1, fill=slope_log_N1))+geom_col()+
scale_fill_viridis(direction = -1)
##ANALYSING PREDICTION POWER OF N1
forward <- 1
N1_casos$log_7_forward <- NA
for (i in 1:nrow(N1_casos)){
N1_casos$log_7_forward[i] <- N1_casos$log_7[i+forward]
}
cor.test(N1_casos$log_7_forward, N1_casos$log_N1, method="pearson")
N1_casos %>%
filter(!is.na(log_7_forward), !is.na(log_N1)) %>%
ggplot(aes(log_7_forward, log_N1))+geom_point()+geom_smooth()
dirname(rstudioapi::getSourceEditorContext()$path)
paste(dirname(rstudioapi::getSourceEditorContext()$path), "data", sep="/")
library(tidyverse)
library(lubridate)
library(viridis)
path <- dirname(rstudioapi::getSourceEditorContext()$path)
source(paste(path,"functions.R", sep="/"))
setwd(path)
#load excel
data <- load_excel()
#create casos for N1 and correlation
N1_casos <- N1_data(data)
#generate a field with rowname
N1_casos$row <- as.integer(rownames(N1_casos))
#generate variables where store slopes
N1_casos$slope_log_7 <- NA
N1_casos$slope_log_N1 <- NA
#indicate size of backtime window
n_casos <- 3
#calculate slope for log_7 and log_N1
for (edar in levels(N1_casos$EDAR)){
casos_edar <- N1_casos %>%
filter(EDAR == edar,
!is.na(log_7),
!is.na(log_N1)) %>%
arrange(Data.mostreig)
for (i in 1:nrow(casos_edar)){
#calculate y for log_7
slope <- create_slope(casos_edar, "log_7", 1, direction = 1)
N1_casos$slope_log_7[casos_edar$row[i]] <- slope
#calculate y for log_N1
slope <- create_slope(casos_edar, "log_N1", 3, direction = -1)
N1_casos$slope_log_N1[casos_edar$row[i]] <- slope
}
}
path <- dirname(rstudioapi::getSourceEditorContext()$path)
source(paste(path,"functions.R", sep="/"))
setwd(path)
#calculate slope for log_7 and log_N1
for (edar in levels(N1_casos$EDAR)){
casos_edar <- N1_casos %>%
filter(EDAR == edar,
!is.na(log_7),
!is.na(log_N1)) %>%
arrange(Data.mostreig)
for (i in 1:nrow(casos_edar)){
#calculate y for log_7
slope <- create_slope(casos_edar, "log_7", 1, direction = 1)
N1_casos$slope_log_7[casos_edar$row[i]] <- slope
#calculate y for log_N1
slope <- create_slope(casos_edar, "log_N1", 3, direction = -1)
N1_casos$slope_log_N1[casos_edar$row[i]] <- slope
}
}
#calculate correlation
cor.test(N1_casos$slope_log_7, N1_casos$slope_log_N1, method="pearson")
#scatterplot with slopes
N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+geom_point()+geom_smooth()
#example of data for one EDAR
N1_casos %>%
filter(EDAR == "DGIR") %>%
arrange(Data.mostreig) %>%
ggplot(aes(Data.mostreig, log_N1, fill=slope_log_N1))+geom_col()+
scale_fill_viridis(direction = -1)
##ANALYSING PREDICTION POWER OF N1
forward <- 1
N1_casos$log_7_forward <- NA
for (i in 1:nrow(N1_casos)){
N1_casos$log_7_forward[i] <- N1_casos$log_7[i+forward]
}
cor.test(N1_casos$log_7_forward, N1_casos$log_N1, method="pearson")
N1_casos %>%
filter(!is.na(log_7_forward), !is.na(log_N1)) %>%
ggplot(aes(log_7_forward, log_N1))+geom_point()+geom_smooth()
N1_casos %>%
filter(!is.na(log_7_forward), !is.na(log_N1)) %>%
ggplot(aes(log_7_forward, log_N1, color=log_N1))+geom_point()+geom_smooth()
p0+p1
#example of data for one EDAR
p0 <-  N1_casos %>%
filter(EDAR == "DGIR") %>%
arrange(Data.mostreig) %>%
ggplot(aes(Data.mostreig, log_N1, fill=slope_log_N1))+geom_col()+
scale_fill_viridis(direction = -1)
p1 <- N1_casos %>%
filter(!is.na(log_7_forward), !is.na(log_N1)) %>%
ggplot(aes(log_7_forward, log_N1, color=log_N1))+geom_point()+geom_smooth()
p0+p1
library(patchwork)
p0 + p1
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+geom_point()+geom_smooth()
p0 + p1
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point()+
geom_smooth()+
theme(legend.title = element_blank())
p0 + p1
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point()+
geom_smooth()+
theme(legend.title = element_blank())
p0
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point()+
geom_smooth()+
theme(legend = element_blank())
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1), show.legend = F)+
geom_point()+
geom_smooth()
p0
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point(show.legend = F)+
geom_smooth()
N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point(show.legend = F)+
geom_smooth()
#scatterplot with slopes
p0 <- N1_casos %>%
filter(!is.na(slope_log_7), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7, slope_log_N1, color=log_N1))+
geom_point()+
geom_smooth()+
theme(legend.position = 'none')
p0 + p1
N1_casos$slope_log_7_forward <- NA
for (i in 1:nrow(N1_casos)){
N1_casos$slope_log_7_forward[i] <- N1_casos$slope_log_7[i+forward]
}
cor.test(N1_casos$log_7_forward, N1_casos$log_N1, method="pearson")
cor.test(N1_casos$slope_log_7_forward, N1_casos$slope_log_N1, method="pearson")
View(N1_casos)
N1_casos$slope_log_7_forward <- NA
for (i in 1:nrow(N1_casos)){
N1_casos$slope_log_7_forward[i] <- N1_casos$slope_log_7[i+forward]
}
cor.test(N1_casos$slope_log_7_forward, N1_casos$slope_log_N1, method="pearson")
#calculate correlation
cor.test(N1_casos$slope_log_7, N1_casos$slope_log_N1, method="pearson")
p1 <- N1_casos %>%
filter(!is.na(slope_log_7_forward), !is.na(slope_log_N1)) %>%
ggplot(aes(log_7_forward, log_N1, color=log_N1))+geom_point()+geom_smooth()
p0 + p1
p1 <- N1_casos %>%
filter(!is.na(slope_log_7_forward), !is.na(slope_log_N1)) %>%
ggplot(aes(slope_log_7_forward, slope_log_N1, color=log_N1))+geom_point()+geom_smooth()
p0 + p1
